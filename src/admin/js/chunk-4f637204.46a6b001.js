(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4f637204"],{"0a49":function(e,t,i){var n=i("9b43"),s=i("626a"),a=i("4bf8"),l=i("9def"),r=i("cd1c");e.exports=function(e,t){var i=1==e,o=2==e,c=3==e,u=4==e,d=6==e,f=5==e||d,h=t||r;return function(t,r,p){for(var m,v,g=a(t),b=s(g),y=n(r,p,3),w=l(b.length),x=0,k=i?h(t,w):o?h(t,0):void 0;w>x;x++)if((f||x in b)&&(m=b[x],v=y(m,x,g),e))if(i)k[x]=v;else if(v)switch(e){case 3:return!0;case 5:return m;case 6:return x;case 2:k.push(m)}else if(u)return!1;return d?-1:c||u?u:k}}},"1b17":function(e,t,i){"use strict";i("7fd8")},"20d6":function(e,t,i){"use strict";var n=i("5ca1"),s=i("0a49")(6),a="findIndex",l=!0;a in[]&&Array(1)[a]((function(){l=!1})),n(n.P+n.F*l,"Array",{findIndex:function(e){return s(this,e,arguments.length>1?arguments[1]:void 0)}}),i("9c6c")(a)},"28a5":function(e,t,i){"use strict";var n=i("aae3"),s=i("cb7c"),a=i("ebd6"),l=i("0390"),r=i("9def"),o=i("5f1b"),c=i("520a"),u=i("79e5"),d=Math.min,f=[].push,h="split",p="length",m="lastIndex",v=4294967295,g=!u((function(){RegExp(v,"y")}));i("214f")("split",2,(function(e,t,i,u){var b;return b="c"=="abbc"[h](/(b)*/)[1]||4!="test"[h](/(?:)/,-1)[p]||2!="ab"[h](/(?:ab)*/)[p]||4!="."[h](/(.?)(.?)/)[p]||"."[h](/()()/)[p]>1||""[h](/.?/)[p]?function(e,t){var s=String(this);if(void 0===e&&0===t)return[];if(!n(e))return i.call(s,e,t);var a,l,r,o=[],u=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),d=0,h=void 0===t?v:t>>>0,g=new RegExp(e.source,u+"g");while(a=c.call(g,s)){if(l=g[m],l>d&&(o.push(s.slice(d,a.index)),a[p]>1&&a.index<s[p]&&f.apply(o,a.slice(1)),r=a[0][p],d=l,o[p]>=h))break;g[m]===a.index&&g[m]++}return d===s[p]?!r&&g.test("")||o.push(""):o.push(s.slice(d)),o[p]>h?o.slice(0,h):o}:"0"[h](void 0,0)[p]?function(e,t){return void 0===e&&0===t?[]:i.call(this,e,t)}:i,[function(i,n){var s=e(this),a=void 0==i?void 0:i[t];return void 0!==a?a.call(i,s,n):b.call(String(s),i,n)},function(e,t){var n=u(b,e,this,t,b!==i);if(n.done)return n.value;var c=s(e),f=String(this),h=a(c,RegExp),p=c.unicode,m=(c.ignoreCase?"i":"")+(c.multiline?"m":"")+(c.unicode?"u":"")+(g?"y":"g"),y=new h(g?c:"^(?:"+c.source+")",m),w=void 0===t?v:t>>>0;if(0===w)return[];if(0===f.length)return null===o(y,f)?[f]:[];var x=0,k=0,I=[];while(k<f.length){y.lastIndex=g?k:0;var _,C=o(y,g?f:f.slice(k));if(null===C||(_=d(r(y.lastIndex+(g?0:k)),f.length))===x)k=l(f,k,p);else{if(I.push(f.slice(x,k)),I.length===w)return I;for(var L=1;L<=C.length-1;L++)if(I.push(C[L]),I.length===w)return I;k=x=_}}return I.push(f.slice(x)),I}]}))},"7fd8":function(e,t,i){},cd1c:function(e,t,i){var n=i("e853");e.exports=function(e,t){return new(n(e))(t)}},db55:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"app-container"},[t("div",{staticClass:"filter-container"},[t("el-button",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"filter-item",attrs:{type:"primary",title:"刷新",circle:"",icon:"el-icon-refresh"},on:{click:e.getList}}),e.permission.create?t("el-button",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{type:"primary",icon:"el-icon-edit"},on:{click:e.handleCreate}},[e._v("添加\n    ")]):e._e()],1),t("el-table",{attrs:{border:"","highlight-current-row":"",data:e.tableList}},[t("el-table-column",{attrs:{align:"center",label:"序号",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.$index+1)+"\n      ")]}}])}),t("el-table-column",{attrs:{prop:"title",label:"部门名称"}}),t("el-table-column",{attrs:{prop:"desc",label:"描述"}}),t("el-table-column",{attrs:{label:"操作",width:"200px"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("el-button-group",[e.permission.auth?t("el-button",{attrs:{type:"success",size:"small"},on:{click:function(t){return e.setMenu(i.row)}}},[e._v("授权")]):e._e(),e.permission.edit?t("el-button",{attrs:{type:"warning",size:"small"},on:{click:function(t){return e.updateItem(i.row)}}},[e._v("编辑")]):e._e(),e.permission.delete?t("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(t){return e.delItem(i.row.id)}}},[e._v("删除")]):e._e()],1)]}}])})],1),t("el-dialog",{attrs:{title:"部门",visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("el-form",{ref:"newItem",attrs:{model:e.newItem,rules:e.newItemRules,"label-width":"100px"}},[t("el-form-item",{attrs:{label:"部门名称",prop:"title"}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.newItem.title,callback:function(t){e.$set(e.newItem,"title",t)},expression:"newItem.title"}})],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.confirmCreateItem}},[e._v("确 定")])],1)],1),t("el-dialog",{attrs:{title:"授权",visible:e.MenuDialogVisible},on:{"update:visible":function(t){e.MenuDialogVisible=t}}},[t("menus",{attrs:{"default-keys":e.menuListChecked},on:{save:e.saveMenuRules}})],1)],1)},s=[],a=(i("20d6"),i("28a5"),function(){var e=this,t=e._self._c;return t("div",{staticClass:"app-container",staticStyle:{height:"500px",overflow:"auto"}},[t("div",{staticClass:"filter-container"},[t("el-button",{attrs:{type:"primary"},on:{click:e.saveMenus}},[e._v("确定")])],1),t("div",{staticClass:"wrapper"},[t("el-tree",{ref:"treeList",attrs:{"check-strictly":e.checkStrictly,"default-expand-all":e.expendAll,data:e.menuList,"show-checkbox":"","node-key":"id",props:e.defaultProps}})],1),t("div",{staticClass:"pagination-container"},[t("el-button",{attrs:{type:"primary"},on:{click:e.saveMenus}},[e._v("确定")])],1)])}),l=[],r={name:"Menus",props:{defaultKeys:{type:Array,default:function(){return[]}}},data:function(){return{menuList:[],expendAll:!0,checkStrictly:!1,defaultProps:{children:"children",label:"title"}}},created:function(){this.getList()},mounted:function(){var e=this;setTimeout((function(){e.setChecked(e.defaultKeys)}),750)},watch:{defaultKeys:function(e){this.setChecked(e)}},methods:{getList:function(){var e=this;this.$ajax.get("/api/admin_rule").then((function(t){e.menuList=t}))},saveMenus:function(){var e=this.$refs.treeList.getCheckedKeys(),t=this.$refs.treeList.getHalfCheckedKeys();e=e.concat(t),this.$emit("save",e)},setChecked:function(e){var t=this;this.checkStrictly=!0,this.$nextTick((function(){t.$refs.treeList.setCheckedKeys(e),t.checkStrictly=!1}))}}},o=r,c=(i("1b17"),i("2877")),u=Object(c["a"])(o,a,l,!1,null,"0cdbddf7",null),d=u.exports,f={name:"AdminDepIndex",components:{Menus:d},data:function(){return{permission:{create:this.$checkAuth("AdminDepCreate"),edit:this.$checkAuth("AdminDepEdit"),delete:this.$checkAuth("AdminDepDelete"),auth:this.$checkAuth("AdminDepAuth")},tableList:[],map:{},loading:!1,dialogVisible:!1,MenuDialogVisible:!1,newItem:{},newItemRules:{title:[{required:!0,message:"部门名称必填"}]},menuListChecked:[],currentGroupId:""}},created:function(){this.getList()},methods:{setMenu:function(e){this.menuListChecked=e.rules&&e.rules.length>0?e.rules.split(","):[],this.currentGroupId=e.id,this.MenuDialogVisible=!0},saveMenuRules:function(e){var t=this;this.$ajax.post("/api/admin_dep/setRules/id/"+this.currentGroupId,{rules:e}).then((function(){t.$message.success("授权成功");var i=t.tableList.findIndex((function(e){return e.id===t.currentGroupId})),n=t.tableList[i];n.rules=e.join(","),t.$set(t.tableList,i,n),t.MenuDialogVisible=!1}))},handleCreate:function(){this.newItem={},this.dialogVisible=!0},getList:function(){var e=this;this.loading=!0,this.$ajax.get("/api/admin_dep").then((function(t){e.loading=!1,e.tableList=t})).catch((function(){e.loading=!1}))},delItem:function(e){var t=this;this.$confirm("确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.$ajax.post("/api/admin_dep/delete/id/"+e).then((function(){t.loading=!0,t.$notify({title:"成功",message:"删除成功",type:"success",duration:2e3});var i=t.tableList.findIndex((function(t){return t.id===e}));t.tableList.splice(i,1),t.total-=1,t.loading=!1}))}))},updateItem:function(e){this.newItem=e,this.dialogVisible=!0},upItem:function(e,t){var i=this;this.$ajax.post("/api/admin_dep/update/id/"+t,e).then((function(){i.$message({message:"更新成功",type:"success"}),i.dialogVisible=!1}))},confirmCreateItem:function(){var e=this;if(this.newItem.id)return this.upItem(this.newItem,this.newItem.id),!1;this.$refs.newItem.validate((function(t){t&&(e.loading=!0,e.$ajax.post("/api/admin_dep/add",e.newItem).then((function(t){e.loading=!1,e.$notify({title:"成功",message:"添加成功",type:"success",duration:2e3}),e.getList(),e.dialogVisible=!1})).catch((function(){e.loading=!1})))}))}}},h=f,p=Object(c["a"])(h,n,s,!1,null,"25c53e2f",null);t["default"]=p.exports},e853:function(e,t,i){var n=i("d3f4"),s=i("1169"),a=i("2b4c")("species");e.exports=function(e){var t;return s(e)&&(t=e.constructor,"function"!=typeof t||t!==Array&&!s(t.prototype)||(t=void 0),n(t)&&(t=t[a],null===t&&(t=void 0))),void 0===t?Array:t}}}]);