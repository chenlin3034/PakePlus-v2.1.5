(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6f6d9292"],{"0e05":function(e,t,i){"use strict";i.d(t,"a",(function(){return r})),i.d(t,"c",(function(){return a})),i.d(t,"b",(function(){return n}));var r=function(e,t,i){if(t){var r=/^1[3456789]\d{9}$/;r.test(t)?i():i(new Error("手机号格式错误"))}else i()},a=function(e,t,i){if(t){var r=/^((0\d{2,3})-)(\d{7,8})(-(\d{3,}))?$/;r.test(t)?i():i(new Error("电话号格式错误"))}else i()},n=function(e,t,i){if(t){var r=/^1[3456789]\d{9}$/,a=/^((0\d{2,3})-)(\d{7,8})(-(\d{3,}))?$/;r.test(t)||a.test(t)?i():i(new Error("电话号格式错误"))}else i()}},"1d46":function(e,t,i){"use strict";i.r(t);var r=function(){var e=this,t=e._self._c;return t("el-row",{staticClass:"app-container"},[t("el-col",{attrs:{span:20}},[t("el-form",{ref:"newItem",attrs:{model:e.item,rules:e.itemRules,"label-width":"100px"}},[t("el-form-item",{attrs:{label:"用户名",prop:"username"}},[t("div",[t("span",[e._v(e._s(e.item.username))]),0===e.item.weixin?t("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary",size:"mini"},on:{click:e.showWxQrcode}},[e._v("绑定微信")]):e._e()],1)]),t("el-form-item",{attrs:{label:"真实姓名",prop:"realname"}},[t("el-input",{attrs:{autocomplete:"off",placeholder:"如需修改请填写"},model:{value:e.item.realname,callback:function(t){e.$set(e.item,"realname",t)},expression:"item.realname"}})],1),t("el-form-item",{attrs:{label:"手机号",prop:"mobile"}},[t("el-input",{attrs:{autocomplete:"off",placeholder:"手机号"},model:{value:e.item.mobile,callback:function(t){e.$set(e.item,"mobile",t)},expression:"item.mobile"}})],1),t("el-form-item",{attrs:{label:"固话",prop:"tel"}},[t("el-input",{attrs:{type:"text",placeholder:"固话，例如：0311-XXXXXXXX"},model:{value:e.item.tel,callback:function(t){e.$set(e.item,"tel",t)},expression:"item.tel"}})],1),t("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[t("el-input",{attrs:{type:"text",placeholder:"邮箱"},model:{value:e.item.email,callback:function(t){e.$set(e.item,"email",t)},expression:"item.email"}})],1),t("el-form-item",{attrs:{label:"密 码",prop:"password"}},[t("el-input",{attrs:{type:"password",placeholder:"如需修改请填写"},model:{value:e.item.password,callback:function(t){e.$set(e.item,"password",t)},expression:"item.password"}})],1),t("el-form-item",{attrs:{label:"确认密码",prop:"repassword"}},[t("el-input",{attrs:{type:"password",placeholder:"再次输入密码"},model:{value:e.item.repassword,callback:function(t){e.$set(e.item,"repassword",t)},expression:"item.repassword"}})],1),t("el-form-item",{attrs:{label:"服务范围",prop:"service"}},[t("el-input",{attrs:{type:"textarea",placeholder:"服务范围"},model:{value:e.item.service,callback:function(t){e.$set(e.item,"service",t)},expression:"item.service"}})],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:e.confirmCreateItem}},[e._v("提 交")])],1)],1)],1),t("el-dialog",{attrs:{title:"绑定微信",visible:e.showWeixinQrcode},on:{"update:visible":function(t){e.showWeixinQrcode=t}}},[t("div",{staticClass:"wx-qrcode",attrs:{id:"wxqrcode"}})])],1)},a=[],n=i("0e05"),s={name:"UserInfo",data:function(){var e=this,t=function(t,i,r){i!==e.item.password?r(new Error("两次输入密码不一致")):r()};return{loading:!1,item:{status:1},showWeixinQrcode:!1,qrCodeState:"",itemRules:{realname:[{required:!0,message:"姓名必填",trigger:"blur"}],mobile:[{validator:n["b"],trigger:"change"}],tel:[{validator:n["c"],trigger:"change"}],email:[{type:"email",message:"请输入正确的邮箱",trigger:"change"}],password:[{min:6,message:"长度至少6位",trigger:"change"}],repassword:[{validator:t,trigger:"change"}]}}},created:function(){this.getDetail()},mounted:function(){var e=this;window.addEventListener("message",(function(t){var i=t.data,r=i.type,a=i.code,n=i.state;"weixinbind"===r&&(n!==e.qrCodeState+""?e.$message.error({message:"二维码已过期，请重新扫码",type:"error",onClose:function(){e.wxInit()}}):e.bindWx(a))}))},methods:{confirmCreateItem:function(){var e=this;this.$refs.newItem.validate((function(t){t&&e.upItem()}))},upItem:function(){var e=this;this.loading=!0;var t=this.item.password&&this.item.password.length>5;this.$ajax.post("/gov/user/edit",this.item).then((function(){e.loading=!1,e.$notify({title:"成功",message:"更新成功"+(t?"，请重新登录":""),type:"success",duration:2e3,onClose:function(){t&&e.$store.dispatch("LogOut").then((function(){location.reload()}))}})})).finally((function(){e.loading=!1}))},getDetail:function(){var e=this;this.$ajax.post("/gov/user/detail").then((function(t){e.item=t}))},bindWx:function(e){var t=this;this.$ajax.get("/gov/user/weixin-bind?code="+e).then((function(){t.showWeixinQrcode=!1,t.$set(t.item,"weixin",1),t.$message.success("绑定成功")}))},showWxQrcode:function(){var e=this;this.showWeixinQrcode=!0,this.$nextTick((function(){e.wxInit()}))},wxInit:function(){this.qrCodeState=Date.parse(new Date+"")/1e3,new WxLogin({self_redirect:!0,id:"wxqrcode",appid:"wx428f58bfb00d6fb8",scope:"snsapi_login",redirect_uri:encodeURIComponent("https://www.zhongjuce.com/openlogin/weixin.html?a=weixinbind&sty=white"),state:this.qrCodeState,style:"black"})}}},o=s,l=(i("d65c"),i("2877")),c=Object(l["a"])(o,r,a,!1,null,"6c0a9774",null);t["default"]=c.exports},"54df":function(e,t,i){},d65c:function(e,t,i){"use strict";i("54df")}}]);