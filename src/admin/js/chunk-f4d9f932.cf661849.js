(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-f4d9f932"],{"0a49":function(e,t,i){var n=i("9b43"),s=i("626a"),a=i("4bf8"),r=i("9def"),l=i("cd1c");e.exports=function(e,t){var i=1==e,u=2==e,o=3==e,c=4==e,d=6==e,p=5==e||d,f=t||l;return function(t,l,h){for(var m,v,g=a(t),b=s(g),y=n(l,h,3),k=r(b.length),x=0,w=i?f(t,k):u?f(t,0):void 0;k>x;x++)if((p||x in b)&&(m=b[x],v=y(m,x,g),e))if(i)w[x]=v;else if(v)switch(e){case 3:return!0;case 5:return m;case 6:return x;case 2:w.push(m)}else if(c)return!1;return d?-1:o||c?c:w}}},"20d6":function(e,t,i){"use strict";var n=i("5ca1"),s=i("0a49")(6),a="findIndex",r=!0;a in[]&&Array(1)[a]((function(){r=!1})),n(n.P+n.F*r,"Array",{findIndex:function(e){return s(this,e,arguments.length>1?arguments[1]:void 0)}}),i("9c6c")(a)},"219d":function(e,t,i){},"28a5":function(e,t,i){"use strict";var n=i("aae3"),s=i("cb7c"),a=i("ebd6"),r=i("0390"),l=i("9def"),u=i("5f1b"),o=i("520a"),c=i("79e5"),d=Math.min,p=[].push,f="split",h="length",m="lastIndex",v=4294967295,g=!c((function(){RegExp(v,"y")}));i("214f")("split",2,(function(e,t,i,c){var b;return b="c"=="abbc"[f](/(b)*/)[1]||4!="test"[f](/(?:)/,-1)[h]||2!="ab"[f](/(?:ab)*/)[h]||4!="."[f](/(.?)(.?)/)[h]||"."[f](/()()/)[h]>1||""[f](/.?/)[h]?function(e,t){var s=String(this);if(void 0===e&&0===t)return[];if(!n(e))return i.call(s,e,t);var a,r,l,u=[],c=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),d=0,f=void 0===t?v:t>>>0,g=new RegExp(e.source,c+"g");while(a=o.call(g,s)){if(r=g[m],r>d&&(u.push(s.slice(d,a.index)),a[h]>1&&a.index<s[h]&&p.apply(u,a.slice(1)),l=a[0][h],d=r,u[h]>=f))break;g[m]===a.index&&g[m]++}return d===s[h]?!l&&g.test("")||u.push(""):u.push(s.slice(d)),u[h]>f?u.slice(0,f):u}:"0"[f](void 0,0)[h]?function(e,t){return void 0===e&&0===t?[]:i.call(this,e,t)}:i,[function(i,n){var s=e(this),a=void 0==i?void 0:i[t];return void 0!==a?a.call(i,s,n):b.call(String(s),i,n)},function(e,t){var n=c(b,e,this,t,b!==i);if(n.done)return n.value;var o=s(e),p=String(this),f=a(o,RegExp),h=o.unicode,m=(o.ignoreCase?"i":"")+(o.multiline?"m":"")+(o.unicode?"u":"")+(g?"y":"g"),y=new f(g?o:"^(?:"+o.source+")",m),k=void 0===t?v:t>>>0;if(0===k)return[];if(0===p.length)return null===u(y,p)?[p]:[];var x=0,w=0,I=[];while(w<p.length){y.lastIndex=g?w:0;var L,C=u(y,g?p:p.slice(w));if(null===C||(L=d(l(y.lastIndex+(g?0:w)),p.length))===x)w=r(p,w,h);else{if(I.push(p.slice(x,w)),I.length===k)return I;for(var $=1;$<=C.length-1;$++)if(I.push(C[$]),I.length===k)return I;w=x=L}}return I.push(p.slice(x)),I}]}))},3953:function(e,t,i){"use strict";i("219d")},"9a3b":function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"app-container"},[t("div",{staticClass:"filter-container"},[t("el-button",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"filter-item",attrs:{type:"primary",title:"刷新",circle:"",icon:"el-icon-refresh"},on:{click:e.getList}}),e.permission.create?t("el-button",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{type:"primary",icon:"el-icon-edit"},on:{click:e.handleCreate}},[e._v("添加\n    ")]):e._e()],1),t("el-table",{attrs:{border:"","highlight-current-row":"",data:e.tableList}},[t("el-table-column",{attrs:{align:"center",label:"序号",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.$index+1)+"\n      ")]}}])}),t("el-table-column",{attrs:{prop:"title",label:"组名称"}}),t("el-table-column",{attrs:{prop:"desc",label:"描述"}}),t("el-table-column",{attrs:{label:"操作",width:"180px"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("el-button-group",[e.permission.auth?t("el-button",{attrs:{type:"success",size:"mini"},on:{click:function(t){return e.setMenu(i.row)}}},[e._v("授权")]):e._e(),e.permission.authApp?t("el-button",{attrs:{type:"warning",size:"mini"},on:{click:function(t){return e.setAppMenu(i.row)}}},[e._v("APP授权")]):e._e()],1),t("el-button-group",{staticStyle:{"margin-top":"3px"}},[e.permission.edit?t("el-button",{attrs:{type:"warning",size:"mini"},on:{click:function(t){return e.updateItem(i.row)}}},[e._v("编辑")]):e._e(),e.permission.delete?t("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(t){return e.delItem(i.row.id)}}},[e._v("删除")]):e._e()],1)]}}])})],1),t("el-dialog",{attrs:{title:"权限组",visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("el-form",{ref:"newItem",attrs:{model:e.newItem,rules:e.newItemRules,"label-width":"100px"}},[t("el-form-item",{attrs:{label:"名称",prop:"title"}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.newItem.title,callback:function(t){e.$set(e.newItem,"title",t)},expression:"newItem.title"}})],1),t("el-form-item",{attrs:{label:"描述",prop:"desc"}},[t("el-input",{attrs:{type:"textarea",autocomplete:"off"},model:{value:e.newItem.desc,callback:function(t){e.$set(e.newItem,"desc",t)},expression:"newItem.desc"}})],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.confirmCreateItem}},[e._v("确 定")])],1)],1),t("el-dialog",{attrs:{title:"授权",visible:e.MenuDialogVisible},on:{"update:visible":function(t){e.MenuDialogVisible=t}}},[t("menus",{attrs:{"default-keys":e.menuListChecked},on:{save:e.saveMenuRules}})],1),t("el-dialog",{attrs:{title:"APP菜单授权",visible:e.AppMenuDialogVisible},on:{"update:visible":function(t){e.AppMenuDialogVisible=t}}},[t("app-menus",{attrs:{"default-keys":e.appMenuListChecked},on:{save:e.saveAppMenuRules}})],1)],1)},s=[],a=(i("20d6"),i("28a5"),function(){var e=this,t=e._self._c;return t("div",{staticClass:"app-container",staticStyle:{height:"500px",overflow:"auto"}},[t("div",{staticClass:"filter-container"},[t("el-button",{attrs:{type:"primary"},on:{click:e.saveMenus}},[e._v("确定")])],1),t("div",{staticClass:"wrapper"},[t("el-tree",{ref:"treeList",attrs:{"check-strictly":e.checkStrictly,"default-expand-all":e.expendAll,data:e.menuList,"show-checkbox":"","node-key":"id",props:e.defaultProps}})],1),t("div",{staticClass:"pagination-container"},[t("el-button",{attrs:{type:"primary"},on:{click:e.saveMenus}},[e._v("确定")])],1)])}),r=[],l={name:"Menus",props:{defaultKeys:{type:Array,default:function(){return[]}}},data:function(){return{menuList:[],expendAll:!0,checkStrictly:!1,defaultProps:{children:"children",label:"title"}}},created:function(){this.getList()},mounted:function(){var e=this;setTimeout((function(){e.setChecked(e.defaultKeys)}),750)},watch:{defaultKeys:function(e){this.setChecked(e)}},methods:{getList:function(){var e=this;this.$ajax.get("/api/admin_rule").then((function(t){e.menuList=t}))},saveMenus:function(){var e=this.$refs.treeList.getCheckedKeys(),t=this.$refs.treeList.getHalfCheckedKeys();e=e.concat(t),this.$emit("save",e)},setChecked:function(e){var t=this;this.checkStrictly=!0,this.$nextTick((function(){t.$refs.treeList.setCheckedKeys(e),t.checkStrictly=!1}))}}},u=l,o=(i("a747"),i("2877")),c=Object(o["a"])(u,a,r,!1,null,"54bc79aa",null),d=c.exports,p=function(){var e=this,t=e._self._c;return t("div",{staticClass:"app-container",staticStyle:{height:"500px",overflow:"auto"}},[t("div",{staticClass:"filter-container"},[t("el-button",{attrs:{type:"primary"},on:{click:e.saveMenus}},[e._v("确定")])],1),t("div",{staticClass:"wrapper"},[t("el-tree",{ref:"treeList",attrs:{"check-strictly":e.checkStrictly,"default-expand-all":e.expendAll,data:e.menuList,"show-checkbox":"","node-key":"id",props:e.defaultProps}})],1),t("div",{staticClass:"pagination-container"},[t("el-button",{attrs:{type:"primary"},on:{click:e.saveMenus}},[e._v("确定")])],1)])},f=[],h={name:"AppMenus",props:{defaultKeys:{type:Array,default:function(){return[]}}},data:function(){return{menuList:[],expendAll:!0,checkStrictly:!1,defaultProps:{children:"children",label:"title"}}},created:function(){this.getList()},mounted:function(){var e=this;setTimeout((function(){e.setChecked(e.defaultKeys)}),750)},watch:{defaultKeys:function(e){this.setChecked(e)}},methods:{getList:function(){var e=this;this.$ajax.get("/api/app_menu/index").then((function(t){e.menuList=t}))},saveMenus:function(){var e=this.$refs.treeList.getCheckedKeys(),t=this.$refs.treeList.getHalfCheckedKeys();e=e.concat(t),this.$emit("save",e)},setChecked:function(e){var t=this;this.checkStrictly=!0,this.$nextTick((function(){t.$refs.treeList.setCheckedKeys(e),t.checkStrictly=!1}))}}},m=h,v=(i("3953"),Object(o["a"])(m,p,f,!1,null,"bdeb7240",null)),g=v.exports,b={name:"UserRoleIndex",components:{Menus:d,AppMenus:g},data:function(){return{permission:{create:this.$checkAuth("UserRoleCreate"),edit:this.$checkAuth("UserRoleEdit"),delete:this.$checkAuth("UserRoleDelete"),auth:this.$checkAuth("UserRoleAuth"),authApp:this.$checkAuth("UserAppMenuAuth")},tableList:[],map:{},loading:!1,dialogVisible:!1,MenuDialogVisible:!1,AppMenuDialogVisible:!1,newItem:{},newItemRules:{title:[{required:!0,message:"名称必填"}]},menuListChecked:[],appMenuListChecked:[],currentGroupId:""}},created:function(){this.getList()},methods:{setAppMenu:function(e){this.appMenuListChecked=e.app_menus&&e.app_menus.length>0?e.app_menus.split(","):[],this.currentGroupId=e.id,this.AppMenuDialogVisible=!0},saveAppMenuRules:function(e){var t=this;this.$ajax.post("/api/group/setAppMenus/id/"+this.currentGroupId,{app_menus:e}).then((function(){t.$message.success("授权成功");var i=t.tableList.findIndex((function(e){return e.id===t.currentGroupId})),n=t.tableList[i];n.app_menus=e.join(","),t.$set(t.tableList,i,n),t.AppMenuDialogVisible=!1}))},setMenu:function(e){this.menuListChecked=e.rules&&e.rules.length>0?e.rules.split(","):[],this.currentGroupId=e.id,this.MenuDialogVisible=!0},saveMenuRules:function(e){var t=this;this.$ajax.post("/api/group/setRules/id/"+this.currentGroupId,{rules:e}).then((function(){t.$message.success("授权成功");var i=t.tableList.findIndex((function(e){return e.id===t.currentGroupId})),n=t.tableList[i];n.rules=e.join(","),t.$set(t.tableList,i,n),t.MenuDialogVisible=!1}))},handleCreate:function(){this.newItem={},this.dialogVisible=!0},getList:function(){var e=this;this.loading=!0,this.$ajax.get("/api/group").then((function(t){e.loading=!1,e.tableList=t})).catch((function(){e.loading=!1}))},delItem:function(e){var t=this;this.$confirm("确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.$ajax.post("/api/group/delete/id/"+e).then((function(){t.loading=!0,t.$notify({title:"成功",message:"删除成功",type:"success",duration:2e3});var i=t.tableList.findIndex((function(t){return t.id===e}));t.tableList.splice(i,1),t.total-=1,t.loading=!1}))}))},updateItem:function(e){this.newItem=e,this.dialogVisible=!0},upItem:function(e,t){var i=this;this.$ajax.post("/api/group/update/id/"+t,e).then((function(){i.$message({message:"更新成功",type:"success"}),i.dialogVisible=!1}))},confirmCreateItem:function(){var e=this;if(this.newItem.id)return this.upItem(this.newItem,this.newItem.id),!1;this.$refs.newItem.validate((function(t){t&&(e.loading=!0,e.$ajax.post("/api/group/add",e.newItem).then((function(t){e.loading=!1,e.$notify({title:"成功",message:"添加成功",type:"success",duration:2e3}),e.getList(),e.dialogVisible=!1})).catch((function(){e.loading=!1})))}))}}},y=b,k=Object(o["a"])(y,n,s,!1,null,"d32a6234",null);t["default"]=k.exports},a747:function(e,t,i){"use strict";i("de07")},cd1c:function(e,t,i){var n=i("e853");e.exports=function(e,t){return new(n(e))(t)}},de07:function(e,t,i){},e853:function(e,t,i){var n=i("d3f4"),s=i("1169"),a=i("2b4c")("species");e.exports=function(e){var t;return s(e)&&(t=e.constructor,"function"!=typeof t||t!==Array&&!s(t.prototype)||(t=void 0),n(t)&&(t=t[a],null===t&&(t=void 0))),void 0===t?Array:t}}}]);